var G_HMI__TIMER_BLINK_PERIOD=1000*1;var G_HMI__TIMER_BLINK_ID=-1;var G_HMI__BLINK_STATE=false;var G_HMI__BITLAMPBLINK_NODES=null;function HMI_TimerBlinkHandler(){for(var a in G_HMI__BITLAMPBLINK_NODES){if(typeof G_HMI__BITLAMPBLINK_NODES[a]=="object"){if(G_HMI__BITLAMPBLINK_NODES[a]){if(typeof G_HMI__BITLAMPBLINK_NODES[a]["Node"]=="object"&&typeof G_HMI__BITLAMPBLINK_NODES[a]["Value"]=="boolean"){if(G_HMI__BITLAMPBLINK_NODES[a]["Node"]){if(G_HMI__BITLAMPBLINK_NODES[a]["Value"]){G_HMI__BITLAMPBLINK_NODES[a]["Node"].toggle(G_HMI__BLINK_STATE)}else{if(G_HMI__BITLAMPBLINK_NODES[a]["Node"].is(":visible")){G_HMI__BITLAMPBLINK_NODES[a]["Node"].hide()}}}}}}}G_HMI__BLINK_STATE=(!G_HMI__BLINK_STATE)}function HMI(){this.Options={};this.DefaultValue="---";this.UsePrevValue=true;var e={};var g={};var b=false;this.isOption=function(i){if(b&&typeof i=="object"){var h=new Array({name:"DataKey",data_type:"string",null_value:false});return check_object(i,h)}return(false)};this.isOptionByKey=function(h){if(typeof h=="string"){if(typeof this.Options[h]=="object"){return(this.isOption(this.Options[h]))}}return(false)};this.getKeys=function(){var i=[];for(var h in this.Options){i.push(h)}return(i)};this.getKeysForOld=function(j){var k=((typeof j=="number")?j:(new Date()).get_current_time_stamp());var i=[];for(var h in this.Options){if(typeof this.Options[h]["Stamp"]=="number"){if(this.Options[h]["Stamp"]<k){i.push(h)}}}return(i)};this.getDefaultValues=function(m){var j={};var k=null;var h=null;if(typeof m!="undefined"){if(is_array(m)){k=m}}if(!k){k=this.getKeys()}for(var l=0;l<k.length;l++){h=k[l];if(this.isOptionByKey(h)){if(typeof this.Options[h]["DefaultValue"]!="undefined"){j[h]=this.Options[h]["DefaultValue"]}}}return(j)};this.setStamp=function(j,h){var i=-1;if(typeof j=="string"&&this.Options){if(typeof this.Options[j]=="object"){if(this.Options[j]){i=((typeof h=="number")?h:(new Date()).get_current_time_stamp());this.Options[j]["Stamp"]=i}}}return(i)};this.fixValue=function(j,h,i){if(typeof j=="string"&&this.Options){if(typeof this.Options[j]=="object"){if(this.Options[j]){this.Options[j]["RawValue"]=((typeof i!="undefined")?i:null);this.Options[j]["Value"]=((typeof h!="undefined")?h:null);this.Options[j]["Stamp"]=(new Date()).get_current_time_stamp()}}}};this.isEqPrev=function(i,h){if(typeof i=="string"&&this.Options){if(typeof this.Options[i]=="object"){if(this.Options[i]){if(typeof h==typeof this.Options[i]["Value"]){if(h==this.Options[i]["Value"]){return(true)}}}}}return(false)};this.toBool=function(h){if(typeof h=="object"||typeof h=="boolean"||typeof h=="number"){if(h){return(true)}}else{if(typeof h=="string"){if(h.length>0){return(true)}}}return(false)};this.setNodeAttr=function(j,i,h){if(typeof j=="object"&&typeof i=="string"){if(i.length){var k=((typeof h=="string"||typeof h=="number")?h:0);if(i=="top"){j.css("top",(""+(k-0)+"px"))}else{if(i=="left"){j.css("left",(""+(k-0)+"px"))}else{j.attr(i,k)}}}}};this.refreshText=function(j,i,h,l){if(b&&typeof j=="object"){if(j){var k=((typeof l=="number"||typeof l=="string")?(""+l):this.DefaultValue);if(typeof h=="number"||typeof h=="string"){k=(""+h)}if(typeof i=="string"){this.setNodeAttr(j,i,k)}else{j.text(k)}return(true)}}return(false)};this.refreshBitLamp=function(k,h,n,p){var o=false;if(b&&typeof k=="object"){if(k){var m=((typeof p=="number"||typeof p=="string"||typeof p=="boolean")?p:false);var j=((typeof n=="boolean")?n:false);var l=k.attr("src0");var i=k.attr("src1");var o=this.toBool(h);if(o){if(typeof i=="string"){k.attr("src",i)}else{if(k.is(":hidden")&&!j){k.show()}}}else{if(typeof l=="string"){k.attr("src",l)}else{if(k.is(":visible")&&!j){k.hide()}}}}}return(o)};var d=function(h){var i=0;if(typeof h=="string"){var j=replace_sub_string("[,]",h,".");i=(j-0)}else{if(typeof h=="number"){i=h}}return(i)};var f=function(h,j){var i=d(h);if(typeof j=="number"){if(j>0){i=(i/j)}}return(i)};var a=function(h,j){var i=d(h);var k=((typeof j=="number")?Math.round(j):0);return(i.toFixed(k)-0)};var c=function(h){var i=d(h);return(Math.floor(i))};this.setLocReg=function(i,h){if(typeof i=="string"){if(i.length){if(typeof g[i]!="undefined"){g[i]=h}}}};this.addLocReg=function(i,h){if(typeof i=="string"&&typeof h=="number"){if(i.length){if(typeof g[i]!="undefined"){g[i]+=h}}}};this.refreshNumber=function(j,i,h,l){if(b&&typeof j=="object"){if(j){var k=this.DefaultValue;if(typeof h=="number"||typeof h=="string"){k=""+d(h)}else{if(typeof l=="number"||typeof l=="string"){k=(""+l)}}if(typeof i=="string"){this.setNodeAttr(j,i,k)}else{j.text(k)}return(true)}}return(false)};this.refreshArrayIDx=function(i,h,n,l,m){if(b&&typeof i=="object"){if(i){var k=null;var j=false;if(typeof m=="string"||typeof m=="number"){k=(""+m)}else{k=this.DefaultValue;j=true}if(typeof l!="undefined"&&(typeof n=="string"||typeof n=="number")){if(typeof l[n]=="string"||typeof l[n]=="number"){k=l[n]}}if(typeof h=="string"){if((h=="class"&&!j)||h!="class"){this.setNodeAttr(i,h,k)}}else{i.text(k)}return(true)}}return(false)};this.refresh=function(n){if(b&&e){var k=false;var i=null;var m=null;var j=null;var l=null;var p=null;var h=false;for(var o in e){if(typeof this.Options[o]=="object"){if(this.isOption(this.Options[o])){l=((typeof this.Options[o]["DefaultValue"]!="undefined")?this.Options[o]["DefaultValue"]:null);i=((this.UsePrevValue&&typeof this.Options[o]["RawValue"]!="undefined")?this.Options[o]["RawValue"]:l);j=this.Options[o]["DataKey"];p=((typeof this.Options[o]["NodeAttr"]=="string")?this.Options[o]["NodeAttr"]:null);h=((typeof this.Options[o]["Inverted"]=="boolean")?this.Options[o]["Inverted"]:false);if(typeof n=="object"){if(n){if(typeof n[j]!="undefined"){i=n[j]}}}m=i;if(typeof m=="number"||typeof m=="string"){if(typeof this.Options[o]["Offset"]=="number"){if(this.Options[o]["Offset"]>0){m=f(m,this.Options[o]["Offset"])}}if(typeof this.Options[o]["Round"]=="number"){m=a(m,this.Options[o]["Round"])}if(typeof this.Options[o]["Floor"]=="boolean"){if(this.Options[o]["Floor"]){m=c(m)}}}if(typeof m=="number"){if(typeof this.Options[o]["Inc"]=="number"){if(this.Options[o]["Inc"]!=0){m+=this.Options[o]["Inc"]}}if(typeof this.Options[o]["Dec"]=="number"){if(this.Options[o]["Dec"]!=0){m-=this.Options[o]["Dec"]}}if(typeof this.Options[o]["Bit"]=="number"){m=((h&&typeof invertBit=="function")?invertBit(m,this.Options[o]["Bit"]):m);m=((typeof getBit=="function")?getBit(m,this.Options[o]["Bit"]):0)}if(typeof this.Options[o]["Not"]=="boolean"){if(this.Options[o]["Not"]){m=~m}}if(typeof this.Options[o]["AndMask"]=="number"){m=(m&this.Options[o]["AndMask"])}if(typeof this.Options[o]["OrMask"]=="number"){m=(m|this.Options[o]["OrMask"])}if(typeof this.Options[o]["XorMask"]=="number"){m=(m^this.Options[o]["XorMask"])}if(typeof this.Options[o]["NotAfter"]=="boolean"){if(this.Options[o]["NotAfter"]){m=~m}}if(typeof this.Options[o]["IncAfter"]=="number"){m+=this.Options[o]["IncAfter"]}if(typeof this.Options[o]["DecAfter"]=="number"){m-=this.Options[o]["DecAfter"]}}if(typeof this.Options[o]["BoolNum"]=="boolean"){if(this.Options[o]["BoolNum"]){m=((this.toBool(m))?1:0)}}if(typeof this.Options[o]["SetLocReg"]=="string"){this.setLocReg(this.Options[o]["SetLocReg"],m)}if(typeof this.Options[o]["AddLocReg"]=="string"){this.addLocReg(this.Options[o]["AddLocReg"],m)}if(typeof this.Options[o]["RiseEdge"]=="boolean"){if(this.Options[o]["RiseEdge"]){if(this.isEqPrev(o,m)){continue}}}if(typeof this.Options[o]["Type"]=="string"){switch(this.Options[o]["Type"]){case"BitLamp":case"BitLampBlink":k=((this.Options[o]["Type"]=="BitLampBlink")?this.refreshBitLamp(e[o],m,true,l):this.refreshBitLamp(e[o],m,false,l));if(typeof G_HMI__BITLAMPBLINK_NODES[o]!="undefined"){G_HMI__BITLAMPBLINK_NODES[o]["Value"]=k}break;case"Text":case"String":k=this.refreshText(e[o],p,m,l);break;case"Number":k=this.refreshNumber(e[o],p,m,l);break;case"ArrayIDx":if(typeof this.Options[o]["Arr"]!="undefined"){k=this.refreshArrayIDx(e[o],p,m,this.Options[o]["Arr"],l)}break;case"IsoTime":m=(new Date()).SecToIsoTime(m-0);k=this.refreshText(e[o],p,m,l)}}if(typeof this.Options[o]["BitFunc"]=="function"){if(this.toBool(m)){k=this.Options[o]["BitFunc"](e[o],m,o,j,n)}}else{if(typeof this.Options[o]["Func"]=="function"){if(this.Options[o]["Type"]=="BitFunc"){if(this.toBool(m)){k=this.Options[o]["Func"](e[o],m,o,j,n)}}else{k=this.Options[o]["Func"](e[o],m,o,j,n)}}}if(typeof this.Options[o]["Reset"]=="boolean"){if(this.Options[o]["Reset"]){m=null;if(typeof this.Options[o]["LocReg"]=="string"){this.setLocReg(this.Options[o]["LocReg"],m)}}}this.fixValue(o,m,i)}}}}};this.refreshLocReg=function(){this.refresh(g)};this.copyOptionsFrom=function(j){var h={};if(typeof j=="object"){if(j){for(var i in j){h[i]=j[i]}}}return(h)};this.setOptionsFrom=function(l,k,m){var n=0;if(b&&typeof l=="string"&&typeof m=="object"){if(is_array(m)){var q=null;var p=false;var h=false;var o=false;if(!this.Options){this.Options={}}for(var j=0;j<m.length;j++){if(typeof m[j]=="object"){if(m[j]){p=false;if(typeof m[j]["NodeID"]=="string"){if(m[j]["NodeID"].length){p=true}}h=false;if(typeof m[j]["DataKey"]=="string"){if(m[j]["DataKey"].length){h=true}}o=false;if(typeof m[j]["NodeAttr"]=="string"){if(m[j]["NodeAttr"].length){o=true}}q=((o==true)?(l+m[j]["NodeAttr"]):l);this.Options[q]=this.copyOptionsFrom(m[j]);if(!p){this.Options[q]["NodeID"]=l}if(!h){this.Options[q]["DataKey"]=((typeof m[j]["PreDataKey"]=="string"&&(typeof k=="number"||typeof k=="string"))?(m[j]["PreDataKey"]+k):l)}n++}}}}}return(n)};this.setDefault=function(i){var h=((typeof i!="undefined")?this.getDefaultValues(i):null);this.refresh(h)};this.setDefaultForOld=function(j){var h=this.getKeysForOld(j);var i=this.getDefaultValues(h);this.refresh(i)};this.init=function(){e={};G_HMI__BITLAMPBLINK_NODES={};if(b&&typeof this.Options=="object"){if(this.Options){for(var h in this.Options){if(typeof this.Options[h]=="object"){if(this.isOption(this.Options[h])){e[h]=$(("#"+((typeof this.Options[h]["NodeID"]=="string")?this.Options[h]["NodeID"]:h)));if(this.Options[h]["Type"]=="BitLampBlink"){G_HMI__BITLAMPBLINK_NODES[h]={Node:e[h],Value:false}}if(typeof this.Options[h]["LocReg"]=="string"){if(this.Options[h]["LocReg"].length){g[this.Options[h]["LocReg"]]=null}}}}}}}};b=(typeof is_empty=="function"&&typeof check_object=="function"&&typeof replace_sub_string=="function"&&typeof is_array=="function");G_HMI__TIMER_BLINK_ID=setInterval(HMI_TimerBlinkHandler,G_HMI__TIMER_BLINK_PERIOD)};