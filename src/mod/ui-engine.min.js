var G_ENGINE_TARGETS={};function isEngineTarget(a){if(typeof check_object=="function"&&typeof a=="string"){if(a.length){if(typeof G_ENGINE_TARGETS[a]=="object"){if(G_ENGINE_TARGETS[a]){var b=new Array({name:"DataForm",data_type:"object",null_value:false},{name:"SelClearSets",data_type:"object",null_value:true},{name:"InitResultset",data_type:"object",null_value:true},{name:"idq",data_type:"string",null_value:true},{name:"KeyField",data_type:"string",null_value:false});return(check_object(G_ENGINE_TARGETS[a],b))}}}}return(false)}function delEngineTarget(a){if(typeof typeof a=="string"){if(a.length){if(typeof G_ENGINE_TARGETS[a]=="objects"){G_ENGINE_TARGETS[a]=null}return(true)}}return(false)}function addEngineTarget(a,b){delEngineTarget(a);if(typeof typeof a=="string"&&typeof b=="object"){if(a.length&&b){G_ENGINE_TARGETS[a]={DataForm:null,KeyField:null,SelClearSets:null,SelFillSets:null,InitResultset:null,idq:null,completed:false,Alias:null,DataTable:null,FuncRefreshView:null,FuncShowDataForm:null};if(typeof b.DataForm=="object"){if(b.DataForm){G_ENGINE_TARGETS[a]["DataForm"]=b.DataForm}}if(typeof b.KeyField=="string"){if(b.KeyField.length){G_ENGINE_TARGETS[a]["KeyField"]=b.KeyField}}if(typeof b.SelClearSets=="object"){if(b.SelClearSets){G_ENGINE_TARGETS[a]["SelClearSets"]=b.SelClearSets}}if(typeof b.SelFillSets=="object"){if(b.SelFillSets){G_ENGINE_TARGETS[a]["SelFillSets"]=b.SelFillSets}}if(typeof b.InitResultset=="object"){if(b.InitResultset){G_ENGINE_TARGETS[a]["InitResultset"]=b.InitResultset}}if(typeof b.idq=="string"){if(b.idq.length){G_ENGINE_TARGETS[a]["idq"]=b.idq}}if(typeof b.completed=="boolean"){G_ENGINE_TARGETS[a]["completed"]=b.completed}if(typeof b.Alias=="string"){if(b.Alias.length){G_ENGINE_TARGETS[a]["Alias"]=b.Alias}}if(typeof b.DataTable=="object"){if(b.DataTable){G_ENGINE_TARGETS[a]["DataTable"]=b.DataTable}}if(typeof b.FuncRefreshView=="function"){G_ENGINE_TARGETS[a]["FuncRefreshView"]=b.FuncRefreshView}if(typeof b.FuncShowDataForm=="function"){G_ENGINE_TARGETS[a]["FuncShowDataForm"]=b.FuncShowDataForm}return(true)}}return(false)}function getSelFillSets(b,a){if(typeof a=="string"){if(a.length){if(isEngineTarget(b)){if(typeof G_ENGINE_TARGETS[b]["SelFillSets"]=="object"){if(G_ENGINE_TARGETS[b]["SelFillSets"]){if(typeof G_ENGINE_TARGETS[b]["SelFillSets"][a]=="object"){return(G_ENGINE_TARGETS[b]["SelFillSets"][a])}}}}}}return(null)}function isDataFormCompleted(a){if(isEngineTarget(a)){if(typeof G_ENGINE_TARGETS[a]["completed"]=="boolean"){return(G_ENGINE_TARGETS[a]["completed"])}}return(false)}function setDataFormCompleteStatus(b,a){if(isEngineTarget(b)){if(typeof G_ENGINE_TARGETS[b]["completed"]=="boolean"){G_ENGINE_TARGETS[b]["completed"]=((typeof a=="boolean")?a:false);return(G_ENGINE_TARGETS[b]["completed"])}}return(false)}function onDataTableXhr(d,c,a,b){if(typeof G_POPUP_BASIC=="object"){if(G_POPUP_BASIC){var e=new RegExp(/^#error#/gi);if(e.test(b.responseText)){G_POPUP_BASIC.showBasic(b.responseText.replace(/^#[a-zA-Z]*#/gi,""))}}}return(true)}function onDataTableRowUnused(b,a,c){var d=false;if(typeof a.status_code=="number"){d=(a.status_code==0)}else{if(typeof a.state_code=="number"){d=(a.state_code==0)}}if(d){$(b).addClass("unused")}}function onDataTableRowSelected(a){$(this).toggleClass("selected");return(false)}function clearDataTable(a){if(typeof a=="object"){if(a){$(a.table().node()).find("tbody").off("click","tr");a.destroy()}}}function clearDataFormSelect(c,a){if(typeof c=="object"&&typeof a=="string"){if(c&&a.length){var b={};b[a]=c.getListEmptyOneFillset();c.fill(b)}}}function clearDataFormSelects(c,b){if(typeof c=="object"&&typeof b=="object"){if(c&&b){for(var a in b){clearDataFormSelect(c,a)}}}}function setDataForm(d,a,e,c,b){if(typeof d=="object"){if(d){clearDataFormSelects(d,a);d.reset();if(typeof e=="object"){if(e){d.setResultset(e)}}if(typeof b=="object"){if(b){if(typeof G_DEBUG=="boolean"){if(G_DEBUG){console.log("DataForm::fill");console.log(JSON.stringify(b))}}d.fill(b)}}if(typeof c=="object"){if(c){if(typeof G_DEBUG=="boolean"){if(G_DEBUG){console.log("DataForm.setResultset");console.log(JSON.stringify(c))}}d.setResultset(c)}}}}}function showDataForm(d,a,e,c,b){if(typeof d=="object"){if(d){setDataForm(d,a,e,c,b);d.show()}}}function showDataFormByID(b,c,a){if(isEngineTarget(b)){showDataForm(G_ENGINE_TARGETS[b]["DataForm"],G_ENGINE_TARGETS[b]["SelClearSets"],G_ENGINE_TARGETS[b]["InitResultset"],c,a);if(typeof G_ENGINE_TARGETS[b]["FuncShowDataForm"]=="function"){G_ENGINE_TARGETS[b]["FuncShowDataForm"](G_ENGINE_TARGETS[b]["DataForm"])}}}function ajaxDataFormError(c,d,b){if(typeof G_DEBUG=="boolean"){if(G_DEBUG){console.log("DataForm::ajaxError");console.log((c.responseText).replace(/^#[a-zA-Z]*#/gi,""))}}if(typeof G_POPUP_BASIC=="object"){if(G_POPUP_BASIC){var a=new jsResponseResult(c.responseText);if(a.HaveMessage){G_POPUP_BASIC.showBasic(a.Message)}}}}function ajaxDataFormSuccess(b,d,c){if(typeof G_DEBUG=="boolean"){if(G_DEBUG){console.log("DataForm::ajaxSuccess");console.log((c.responseText).replace(/^#[a-zA-Z]*#/gi,""))}}var a=new jsResponseResult(b);if(a.HaveMessage){if(typeof G_POPUP_BASIC=="object"){if(G_POPUP_BASIC){G_POPUP_BASIC.showBasic(a.Message)}}}if(isEngineTarget(a.TargetID)){if(G_ENGINE_TARGETS[a.TargetID]["DataForm"]["AjaxOptions"]["data"]["idq"]==a.idq){switch(a.idq){case"insert_data":case"update_data":if(typeof G_ENGINE_TARGETS[a.TargetID]["FuncRefreshView"]=="function"){G_ENGINE_TARGETS[a.TargetID]["FuncRefreshView"]()}break;case"get_data_form":case"get_data_form_fillset":if(a.Status){showDataFormByID(a.TargetID,a.Data,a.Fillset);G_ENGINE_TARGETS[a.TargetID]["completed"]=true}break;case"get_data_form_fillset_item":if(a.Status){G_ENGINE_TARGETS[a.TargetID]["DataForm"].fill(a.Fillset)}break}}}}function onDataFormSaveClicked(c){var b=$(c.target).attr("target-id");if(isEngineTarget(b)){var a=G_ENGINE_TARGETS[b]["DataForm"].getResultset();if(a&&G_ENGINE_TARGETS[b]["idq"].length){G_ENGINE_TARGETS[b]["DataForm"]["AjaxOptions"]["data"]=a;G_ENGINE_TARGETS[b]["DataForm"]["AjaxOptions"]["data"]["target_id"]=b;G_ENGINE_TARGETS[b]["DataForm"]["AjaxOptions"]["data"]["idq"]=G_ENGINE_TARGETS[b]["idq"];G_ENGINE_TARGETS[b]["DataForm"].ajax()}}return(true)}function onDataFormCancelClicked(b){var a=$(b.target).attr("target-id");if(isEngineTarget(a)){if(typeof G_ENGINE_TARGETS[a]["FuncRefreshView"]=="function"){G_ENGINE_TARGETS[a]["FuncRefreshView"]()}}return(true)}function onDataFormItemChanged(e){var d=$(e.target).attr("target-id");if(isEngineTarget(d)){var c=G_ENGINE_TARGETS[d]["DataForm"].getResultset();if(c){G_ENGINE_TARGETS[d]["DataForm"]["AjaxOptions"]["data"]=c;var b=$(e.target).attr("name");var a=getSelFillSets(d,b);if(a){clearDataFormSelects(G_ENGINE_TARGETS[d]["DataForm"],a);G_ENGINE_TARGETS[d]["DataForm"]["AjaxOptions"]["data"]["fillset"]=a}G_ENGINE_TARGETS[d]["DataForm"]["AjaxOptions"]["data"]["target_id"]=d;G_ENGINE_TARGETS[d]["DataForm"]["AjaxOptions"]["data"]["idq"]="get_data_form_fillset_item";G_ENGINE_TARGETS[d]["DataForm"].ajax()}}return(true)}function onAddDataClicked(c){var b=$(c.target).attr("target-id");if(isEngineTarget(b)){var d="";if(typeof G_ENGINE_TARGETS[b]["Alias"]=="string"){if(G_ENGINE_TARGETS[b]["Alias"].length){d=(G_ENGINE_TARGETS[b]["Alias"]+" :: ")}}G_ENGINE_TARGETS[b]["DataForm"].title((d+G_RES[G_LANG]["New"]));G_ENGINE_TARGETS[b]["idq"]="insert_data";var a=((isDataFormCompleted(b))?getSelFillSets(b,"FormCompleted"):getSelFillSets(b,"FormNotCompleted"));if(a){G_ENGINE_TARGETS[b]["DataForm"]["AjaxOptions"]["data"]={};G_ENGINE_TARGETS[b]["DataForm"]["AjaxOptions"]["data"]["target_id"]=b;G_ENGINE_TARGETS[b]["DataForm"]["AjaxOptions"]["data"]["idq"]="get_data_form_fillset";G_ENGINE_TARGETS[b]["DataForm"]["AjaxOptions"]["data"]["fillset"]=a;G_ENGINE_TARGETS[b]["DataForm"].ajax()}else{showDataFormByID(b,null,null)}}return(true)}function onEditDataClicked(d){var b=$(d.target).attr("target-id");if(isEngineTarget(b)){var f="";if(typeof G_ENGINE_TARGETS[b]["Alias"]=="string"){if(G_ENGINE_TARGETS[b]["Alias"].length){f=(G_ENGINE_TARGETS[b]["Alias"]+" :: ")}}G_ENGINE_TARGETS[b]["DataForm"].title((f+G_RES[G_LANG]["Edit"]));G_ENGINE_TARGETS[b]["idq"]="update_data";var c=[];if(typeof G_ENGINE_TARGETS[b]["DataTable"]=="object"){if(G_ENGINE_TARGETS[b]["DataTable"]){c=G_ENGINE_TARGETS[b]["DataTable"].rows(".selected").data()}}if(typeof G_DEBUG=="boolean"){if(G_DEBUG){console.log("EditData::Data.length="+c.length)}}if(c.length==1){if(typeof G_DEBUG=="boolean"){if(G_DEBUG){console.log(c[0])}}G_ENGINE_TARGETS[b]["DataForm"]["AjaxOptions"]["data"]={};var e=G_ENGINE_TARGETS[b]["KeyField"];var a=((isDataFormCompleted(b))?getSelFillSets(b,"FormCompleted"):getSelFillSets(b,"FormNotCompleted"));if(a){G_ENGINE_TARGETS[b]["DataForm"]["AjaxOptions"]["data"]["fillset"]=a}G_ENGINE_TARGETS[b]["DataForm"]["AjaxOptions"]["data"]["target_id"]=b;G_ENGINE_TARGETS[b]["DataForm"]["AjaxOptions"]["data"]["idq"]="get_data_form";G_ENGINE_TARGETS[b]["DataForm"]["AjaxOptions"]["data"][e]=c[0][e];G_ENGINE_TARGETS[b]["DataForm"].ajax()}else{if(typeof G_POPUP_BASIC=="object"){if(G_POPUP_BASIC){G_POPUP_BASIC.showBasic(G_RES[G_LANG]["SelRowToEdit"])}}}}return(true)}function reinitDataFormByID(b){if(isEngineTarget(b)){G_ENGINE_TARGETS[b]["DataForm"].reset();G_ENGINE_TARGETS[b]["DataForm"]["AjaxOptions"]["data"]={};var a=((isDataFormCompleted(b))?getSelFillSets(b,"FormCompleted"):getSelFillSets(b,"FormNotCompleted"));if(a){G_ENGINE_TARGETS[b]["DataForm"]["AjaxOptions"]["data"]["fillset"]=a}G_ENGINE_TARGETS[b]["DataForm"]["AjaxOptions"]["data"]["target_id"]=b;G_ENGINE_TARGETS[b]["DataForm"]["AjaxOptions"]["data"]["idq"]="get_data_form_fillset_item";G_ENGINE_TARGETS[b]["DataForm"].ajax()}}function onRefreshDataViewClicked(b){var a=$(b.target).attr("target-id");if(isEngineTarget(a)){G_ENGINE_TARGETS[a]["completed"]=false}onDataFormCancelClicked(b);return(true)};